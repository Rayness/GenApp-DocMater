<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenApp DocMaster Pro</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <div class="sidebar">
        <!-- HEADER -->
        <div class="sidebar-header">
            <h2>DocMaster Pro 1.3</h2>
            <div style="display: flex; gap: 5px; margin-top: 10px;">
                <button class="btn-primary" style="background: #28a745; margin:0;" onclick="saveProject()">üíæ Save</button>
                <button class="btn-primary" style="background: #17a2b8; margin:0;" onclick="loadProject()">üìÇ Open</button>
            </div>
        </div>
        
        <!-- CONTENT -->
        <div class="sidebar-content">
            <div class="section-title">1. –ò—Å—Ç–æ—á–Ω–∏–∫–∏</div>
            
            <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–µ–∂–∏–º–∞ -->
            <div class="source-switch" style="display: flex; background: #e9ecef; border-radius: 4px; padding: 2px; margin-bottom: 5px;">
                <div id="modeSingle" class="switch-opt active" onclick="setSourceMode('single')">–û–¥–∏–Ω —Ñ–∞–π–ª</div>
                <div id="modeFolder" class="switch-opt" onclick="setSourceMode('folder')">–ü–∞–ø–∫–∞</div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∞ —Ç–µ–ø–µ—Ä—å –æ–¥–Ω–∞, –Ω–æ –¥–µ–ª–∞–µ—Ç —Ä–∞–∑–Ω–æ–µ -->
            <button class="btn-primary" id="btnSelectBg" onclick="selectBackground()">üìÑ –í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª</button>
            <div id="imgName" class="file-status">–ù–µ—Ç —Ñ–∞–π–ª–∞</div>

            <button class="btn-primary" onclick="selectExcel()">üìä –î–∞–Ω–Ω—ã–µ (Excel)</button>
            <div id="xlsName" class="file-status">–ù–µ—Ç —Ñ–∞–π–ª–∞</div>

            <hr>
            <div class="section-title">2. –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å—Ç–∏–ª—å</div>

            <div class="control-group">
                <label>–ö–ª—é—á –ø—Ä–æ–µ–∫—Ç–∞ (Seed):</label>
                <div style="display: flex; gap: 5px;">
                    <input type="text" id="projectSeed" value="default" onchange="updateGlobals()" placeholder="–õ—é–±–æ–µ —Å–ª–æ–≤–æ">
                    <button class="btn-primary" style="width: 35px; margin: 0; background: #6c757d;" onclick="randomizeSeed()" title="–°–±—Ä–æ—Å–∏—Ç—å —Å—Ç–∏–ª–∏ (–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª—é—á)">üé≤</button>
                </div>
                <div style="font-size: 10px; color: #888; margin-top: 2px;">–ú–µ–Ω—è–µ—Ç –ø–æ—á–µ—Ä–∫ –¥–ª—è —Ç–µ—Ö –∂–µ ID</div>
            </div>

            <div class="control-group">
                <label>–®—Ä–∏—Ñ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞:</label>
                <div style="display: flex; gap: 5px;">
                    <select id="globalFont" onchange="updateGlobals()" style="flex-grow: 1;">
                        <option value="random_per_doc">üé≤ –°–ª—É—á–∞–π–Ω—ã–π (–û–¥–∏–Ω –Ω–∞ –¥–æ–∫)</option>
                        <option value="random">üé≤ –°–ª—É—á–∞–π–Ω—ã–π (–†–∞–∑–Ω—ã–µ –ø–æ–ª—è)</option>
                    </select>
                    <!-- –ö–ù–û–ü–ö–ê –ù–ê–°–¢–†–û–ô–ö–ò -->
                    <button class="btn-primary" style="width: 35px; padding: 0; margin: 0; background: #6c757d;" onclick="openFontManager()" title="–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É —à—Ä–∏—Ñ—Ç–æ–≤">‚öôÔ∏è</button>
                </div>
            </div>

            <!-- –ù–û–í–´–ô –°–õ–ê–ô–î–ï–† –†–ê–ó–ú–ï–†–ê -->
            <div class="dual-slider-container" id="grp-size">
                <div class="slider-header">
                    <span>–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞</span>
                    <span class="range-values" id="disp-size">18 - 24</span>
                </div>
                <div class="slider-track-bg"></div>
                <div class="slider-track-fill" id="fill-size"></div>
                <!-- –î–∏–∞–ø–∞–∑–æ–Ω –æ—Ç 10 –¥–æ 100, —à–∞–≥ 1 -->
                <input type="range" class="dual-range" id="sizeMin" min="10" max="100" step="1" value="18" oninput="dualSlide('size')">
                <input type="range" class="dual-range" id="sizeMax" min="10" max="100" step="1" value="24" oninput="dualSlide('size')">
            </div>

            <div class="control-group">
                <label>–¶–≤–µ—Ç —á–µ—Ä–Ω–∏–ª:</label>
                <input type="color" id="globalColor" value="#1414A0" style="width: 100%; height: 30px;" oninput="updateGlobals()">
            </div>
            <details open>
                <summary>‚úçÔ∏è –§–∏–∑–∏–∫–∞ (–î–∏–∞–ø–∞–∑–æ–Ω—ã)</summary>
                <div class="details-content">
                    
                    <!-- === –ö–†–ò–í–ò–ó–ù–ê (0 - 10) === -->
                    <div class="dual-slider-container" id="grp-shake">
                        <div class="slider-header">
                            <span>–ö—Ä–∏–≤–∏–∑–Ω–∞</span>
                            <span class="range-values" id="disp-shake">2.0 - 3.0</span>
                        </div>
                        <!-- –§–æ–Ω –∏ –∑–∞–ª–∏–≤–∫–∞ -->
                        <div class="slider-track-bg"></div>
                        <div class="slider-track-fill" id="fill-shake"></div>
                        <!-- –î–≤–∞ –∏–Ω–ø—É—Ç–∞: Min –∏ Max -->
                        <input type="range" class="dual-range" id="shakeMin" min="0" max="10" step="0.1" value="2" oninput="dualSlide('shake')">
                        <input type="range" class="dual-range" id="shakeMax" min="0" max="10" step="0.1" value="3" oninput="dualSlide('shake')">
                    </div>

                    <!-- === –ù–ê–ñ–ò–ú (0 - 10) === -->
                    <div class="dual-slider-container" id="grp-opacity">
                        <div class="slider-header">
                            <span>–ü–ª–æ—Ç–Ω–æ—Å—Ç—å</span>
                            <span class="range-values" id="disp-opacity">7.0 - 9.0</span>
                        </div>
                        <div class="slider-track-bg"></div>
                        <div class="slider-track-fill" id="fill-opacity"></div>
                        <!-- –î–∏–∞–ø–∞–∑–æ–Ω 0-10 -->
                        <input type="range" class="dual-range" id="opacityMin" min="0" max="10" step="0.5" value="7" oninput="dualSlide('opacity')">
                        <input type="range" class="dual-range" id="opacityMax" min="0" max="10" step="0.5" value="9" oninput="dualSlide('opacity')">
                    </div>

                    <!-- === –†–ê–ó–ú–´–¢–ò–ï (0 - 2) === -->
                    <div class="dual-slider-container" id="grp-blur">
                        <div class="slider-header">
                            <span>–†–∞–∑–º—ã—Ç–∏–µ</span>
                            <span class="range-values" id="disp-blur">0.0 - 0.5</span>
                        </div>
                        <div class="slider-track-bg"></div>
                        <div class="slider-track-fill" id="fill-blur"></div>
                        <input type="range" class="dual-range" id="blurMin" min="0" max="3" step="0.1" value="0" oninput="dualSlide('blur')">
                        <input type="range" class="dual-range" id="blurMax" min="0" max="3" step="0.1" value="0.5" oninput="dualSlide('blur')">
                    </div>
                    <div class="dual-slider-container" id="grp-cvar">
                        <div class="slider-header">
                            <span>–û—Ç—Ç–µ–Ω–æ–∫ (–†–∞–∑–±—Ä–æ—Å)</span>
                            <span class="range-values" id="disp-cvar">0 - 20</span>
                        </div>
                        <div class="slider-track-bg"></div>
                        <div class="slider-track-fill" id="fill-cvar"></div>
                        <!-- –î–∏–∞–ø–∞–∑–æ–Ω —Å–¥–≤–∏–≥–∞ –∫–∞–Ω–∞–ª–æ–≤ RGB (0 - 100) -->
                        <input type="range" class="dual-range" id="cvarMin" min="0" max="100" step="1" value="0" oninput="dualSlide('cvar')">
                        <input type="range" class="dual-range" id="cvarMax" min="0" max="100" step="1" value="20" oninput="dualSlide('cvar')">
                    </div>
                    <!-- === –ù–ê–ö–õ–û–ù (-5 - 5) === -->
                    <div class="dual-slider-container" id="grp-slant">
                        <div class="slider-header">
                            <span>–ù–∞–∫–ª–æ–Ω</span>
                            <span class="range-values" id="disp-slant">-0.5 - 0.5</span>
                        </div>
                        <div class="slider-track-bg"></div>
                        <div class="slider-track-fill" id="fill-slant"></div>
                        <input type="range" class="dual-range" id="slantMin" min="-5" max="5" step="0.1" value="-0.5" oninput="dualSlide('slant')">
                        <input type="range" class="dual-range" id="slantMax" min="-5" max="5" step="0.1" value="0.5" oninput="dualSlide('slant')">
                    </div>

                    <!-- === –†–ê–ó–ë–†–û–° (0 - 20) === -->
                    <div class="dual-slider-container" id="grp-kern">
                        <div class="slider-header">
                            <span>–ö–µ—Ä–Ω–∏–Ω–≥</span>
                            <span class="range-values" id="disp-kern">1 - 3</span>
                        </div>
                        <div class="slider-track-bg"></div>
                        <div class="slider-track-fill" id="fill-kern"></div>
                        <input type="range" class="dual-range" id="kernMin" min="0" max="20" step="1" value="1" oninput="dualSlide('kern')">
                        <input type="range" class="dual-range" id="kernMax" min="0" max="20" step="1" value="3" oninput="dualSlide('kern')">
                    </div>

                    <!-- === –í–ê–†–ò–ê–¶–ò–Ø –í–´–°–û–¢–´ (0 - 50%) === -->
                    <div class="dual-slider-container" id="grp-hvar">
                        <div class="slider-header">
                            <span>–í—ã—Å–æ—Ç–∞ –±—É–∫–≤</span>
                            <span class="range-values" id="disp-hvar">0 - 15</span>
                        </div>
                        <div class="slider-track-bg"></div>
                        <div class="slider-track-fill" id="fill-hvar"></div>
                        <input type="range" class="dual-range" id="hvarMin" min="0" max="50" step="1" value="0" oninput="dualSlide('hvar')">
                        <input type="range" class="dual-range" id="hvarMax" min="0" max="50" step="1" value="15" oninput="dualSlide('hvar')">
                    </div>

                    <!-- === –í–ê–†–ò–ê–¶–ò–Ø –®–ò–†–ò–ù–´ (0 - 50%) === -->
                    <div class="dual-slider-container" id="grp-wvar">
                        <div class="slider-header">
                            <span>–®–∏—Ä–∏–Ω–∞ –±—É–∫–≤</span>
                            <span class="range-values" id="disp-wvar">0 - 10</span>
                        </div>
                        <div class="slider-track-bg"></div>
                        <div class="slider-track-fill" id="fill-wvar"></div>
                        <input type="range" class="dual-range" id="wvarMin" min="0" max="50" step="1" value="0" oninput="dualSlide('wvar')">
                        <input type="range" class="dual-range" id="wvarMax" min="0" max="50" step="1" value="10" oninput="dualSlide('wvar')">
                    </div>

                    <!-- === –î–ï–§–û–†–ú–ê–¶–ò–Ø –ë–£–ö–í (0 - 100) === -->
                    <div class="dual-slider-container" id="grp-distort">
                        <div class="slider-header">
                            <span>–î–µ—Ñ–æ—Ä–º–∞—Ü–∏—è –±—É–∫–≤</span>
                            <span class="range-values" id="disp-distort">0 - 20</span>
                        </div>
                        <div class="slider-track-bg"></div>
                        <div class="slider-track-fill" id="fill-distort"></div>
                        <input type="range" class="dual-range" id="distortMin" min="0" max="100" step="1" value="0" oninput="dualSlide('distort')">
                        <input type="range" class="dual-range" id="distortMax" min="0" max="100" step="1" value="20" oninput="dualSlide('distort')">
                    </div>

                </div>
            </details>
        </div>

        <!-- FOOTER -->
        <div class="sidebar-footer">
            <div class="zoom-controls">
                <small>–ö–æ–ª–µ—Å–∏–∫–æ = –ó—É–º<br>–°—Ä. –∫–Ω–æ–ø–∫–∞ / –ü—Ä–æ–±–µ–ª = –ü–∞–Ω–æ—Ä–∞–º–∞</small>
                <button onclick="resetZoom()">–°–±—Ä–æ—Å –≤–∏–¥–∞</button>
            </div>
            <hr>
            <button class="btn-primary" style="background: #6c757d" onclick="showPreview()">üëÅ –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</button>
            <div style="display: flex; gap: 5px;">
                <button class="btn-primary" id="genBtn" onclick="startGen()" disabled>üöÄ –ü—É—Å–∫</button>
                <button class="btn-primary" style="background: #dc3545; width: 40px;" onclick="stopGen()">‚èπ</button>
            </div>
            
            <div id="progressInfo" style="display: none; margin-top: 10px;">
                <progress id="progressBar" value="0" max="100" style="width:100%"></progress>
                <div id="progVal" style="font-size: 11px; text-align: center;"></div>
            </div>
        </div>
    </div>

    <!-- WORKSPACE –° –ù–û–í–û–ô –°–¢–†–£–ö–¢–£–†–û–ô –î–õ–Ø –ó–£–ú–ê -->
    <div class="workspace" id="workspace">
        <div id="panContainer">
            <div class="canvas-wrapper" id="canvasWrapper">
                <img id="docImage" src="">
                
                <!-- –ú–µ–Ω—é –ø—Ä–∏–≤—è–∑–∞–Ω–æ –∫ canvasWrapper, —á—Ç–æ–±—ã –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤–º–µ—Å—Ç–µ —Å –Ω–∏–º –∏–ª–∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–≥–æ -->
                <div id="floatingToolbar">
                    <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö -->
                    <div class="toolbar-mode-switch">
                        <div id="modeExcel" class="t-switch active" onclick="setZoneMode('excel')">Excel</div>
                        <div id="modeText" class="t-switch" onclick="setZoneMode('text')">–¢–µ–∫—Å—Ç</div>
                    </div>

                    <div class="toolbar-row">
                        <!-- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –õ–ò–ë–û Select, –õ–ò–ë–û Input -->
                        <select id="localColumn" title="–ö–æ–ª–æ–Ω–∫–∞ Excel"></select>
                        <input type="text" id="localStaticText" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç..." style="display: none;">
                        
                        <button class="btn-icon" onclick="duplicateActiveZone()" title="–î—É–±–ª–∏—Ä–æ–≤–∞—Ç—å (Ctrl+D)" style="background: #eef; color: #333;">‚ùê</button>
                        <button class="btn-icon delete" onclick="deleteActiveZone()" title="–£–¥–∞–ª–∏—Ç—å (Delete)">üóë</button>
                    </div>
                    
                    <div class="toolbar-row advanced">
                        <label><input type="checkbox" id="localOverride"> –°–≤–æ–π —Å—Ç–∏–ª—å</label>
                    </div>
                    
                    <div id="localSettings" style="display: none; margin-top: 5px;">
                        <select id="localFont" style="width: 100%; margin-bottom: 3px;"></select>
                        <div class="dual-slider-container" id="grp-localSize" style="height: 35px; margin-bottom: 0;">
                            <!-- –°–ª–∞–π–¥–µ—Ä —Ä–∞–∑–º–µ—Ä–∞ —Å–¥–µ–ª–∞–µ–º –ø–æ–∑–∂–µ –≤ JS –∏–ª–∏ –æ—Å—Ç–∞–≤–∏–º input, 
                                –Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –≤–µ—Ä–Ω–µ–º input number, —Ç–∞–∫ –∫–∞–∫ –º–µ—Å—Ç–∞ –º–∞–ª–æ -->
                            <input type="number" id="localSize" placeholder="–†–∞–∑–º–µ—Ä" style="width: 100%;">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- PREVIEW MODAL -->
    <div class="modal" id="previewModal">
        <img id="previewImg">
        <button class="modal-close" onclick="closePreview()">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>

    <div class="modal" id="fontManagerModal">
        <div class="modal-content-window">
            <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —á–∞—Å—Ç–æ—Ç—ã —à—Ä–∏—Ñ—Ç–æ–≤</h3>
            <p style="font-size: 11px; color: #666; margin-bottom: 10px;">
                0 = –í—ã–∫–ª—é—á–µ–Ω. 10 = –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —á–∞—Å—Ç–æ.
            </p>
            
            <div id="fontListContainer">
                <!-- –°—é–¥–∞ JS –Ω–∞—Ä–∏—Å—É–µ—Ç —Å–ø–∏—Å–æ–∫ —à—Ä–∏—Ñ—Ç–æ–≤ -->
            </div>

            <div style="display: flex; gap: 10px; margin-top: 15px; justify-content: flex-end;">
                <button class="btn-primary" style="width: auto; background: #6c757d;" onclick="closeFontManager()">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn-primary" style="width: auto; background: #28a745;" onclick="saveFontConfig()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>